(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[211],{3466:(e,t,r)=>{Promise.resolve().then(r.bind(r,6265))},5695:(e,t,r)=>{"use strict";var s=r(8999);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},6265:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(5155),a=r(2115),l=r(5695),n=r(3464);let d=["Pending","Preparing","Awaiting Pickup","Out for Delivery","Delivered"];function i(){let[e,t]=(0,a.useState)([]),[r,i]=(0,a.useState)(!1),[c,o]=(0,a.useState)(!0),u=(0,l.useRouter)();(0,a.useEffect)(()=>{(async()=>{try{let e=await n.A.get("http://localhost:8080/currentuserread",{withCredentials:!0});e.data&&"delivery"===e.data.role?i(!0):u.replace("/")}catch(e){console.error("Error checking delivery driver:",e),u.replace("/")}finally{o(!1)}})()},[u]),(0,a.useEffect)(()=>{let e=async()=>{try{let e=await fetch("http://localhost:8080/orderoverallviewnotdelivered",{method:"GET",credentials:"include"}),r=await e.json();t(r)}catch(e){console.error("Error fetching order data:",e)}};e();let r=setInterval(e,1e4);return()=>clearInterval(r)},[]);let h=async(e,r)=>{try{await n.A.post("http://localhost:8080/orderstatusupdate",{orderID:e,newStatus:r},{headers:{"Content-Type":"application/json"},withCredentials:!0})}catch(e){console.error("Error updating status:",e)}t(t=>t.map(t=>t.id===e?{...t,status:r}:t))},p=e=>{switch(e){case"Delivered":return"bg-green-500";case"Out for Delivery":case"Awaiting Pickup":return"bg-yellow-400";case"Pending":return"bg-gray-400";case"Preparing":return"bg-purple-400";default:return"bg-blue-400"}};return c?(0,s.jsx)("p",{children:"Loading..."}):r?(0,s.jsxs)("div",{className:"p-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Delivery Orders"}),0===e.length?(0,s.jsx)("p",{className:"text-lg text-gray-500",children:"No orders assigned yet."}):e.map(e=>(0,s.jsxs)("div",{className:"mb-6 p-6 bg-white rounded-md shadow-md border",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold mb-2",children:["Order #",e.id]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Customer ID:"})," ",e.customerID]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Floor and Room #:"})," ",e.deliveryAddress]}),(0,s.jsxs)("div",{className:"mt-4 flex items-center gap-4",children:[(0,s.jsx)("span",{className:"text-white text-sm px-3 py-1 rounded-full ".concat(p(e.status)),children:e.status}),(0,s.jsx)("select",{className:"border rounded-md px-3 py-1 text-sm",value:e.status,onChange:t=>h(e.id,t.target.value),children:d.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]})]},e.id))]}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[464,441,684,358],()=>t(3466)),_N_E=e.O()}]);