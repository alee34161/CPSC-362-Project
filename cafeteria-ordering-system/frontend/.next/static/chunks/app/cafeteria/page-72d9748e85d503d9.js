(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[571],{833:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var s=r(5155),a=r(2115),i=r(5695),l=r(3464);function n(){let[e,t]=(0,a.useState)([]),[r,n]=(0,a.useState)(!1),[o,d]=(0,a.useState)(!0),c=(0,i.useRouter)();(0,a.useEffect)(()=>{(async()=>{try{let e=await l.A.get("http://localhost:8080/currentuserread",{withCredentials:!0});e.data&&"cafeteria"===e.data.role?n(!0):c.replace("/")}catch(e){console.error("Error checking cafeteria employee:",e),c.replace("/")}finally{d(!1)}})()},[c]),(0,a.useEffect)(()=>{let e=async()=>{try{let e=await l.A.get("http://localhost:8080/orderoverallviewnotdelivered",{withCredentials:!0});console.log("Orders response:",e.data);let r=await Promise.all(e.data.filter(e=>"Pending"===e.status).map(async e=>{let t=await l.A.get("http://localhost:8080/ordercafitemslist",{params:{ordID:e.id},withCredentials:!0});return console.log("Items for order",e.id,t.data),{...e,items:t.data}}));console.log("Orders with merged items:",r),t(r)}catch(e){console.error("Error fetching orders:",e)}};e();let r=setInterval(e,1e4);return()=>clearInterval(r)},[]);let u=async e=>{try{await l.A.post("http://localhost:8080/orderstatusupdate",{orderID:e,newStatus:"Awaiting Pickup"},{headers:{"Content-Type":"application/json"},withCredentials:!0})}catch(e){console.error("Error updating status:",e)}t(t=>t.filter(t=>t.id!==e))};return o?(0,s.jsx)("p",{children:"Loading..."}):r?(0,s.jsxs)("div",{className:"max-w-3xl mx-auto p-6 space-y-6",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Cafeteria Meal Tickets"}),0===e.length?(0,s.jsx)("p",{className:"text-gray-500 text-center mt-12",children:"No current orders."}):e.map(e=>{var t;return(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-4 space-y-4 border border-gray-300 mb-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("h2",{className:"text-xl font-bold text-blue-700",children:["Order #",e.id]}),(0,s.jsx)("button",{onClick:()=>u(e.id),className:"bg-green-600 text-white px-4 py-2 rounded-md text-sm hover:bg-green-700 transition",children:"Ready for Pickup"})]}),(0,s.jsxs)("ul",{className:"list-disc list-inside text-sm text-gray-800 space-y-3",children:[null===(t=e.items)||void 0===t?void 0:t.map((e,t)=>(0,s.jsxs)("li",{className:"pb-3 border-b border-gray-200",children:[" ",(0,s.jsx)("span",{className:"font-medium",children:e.name}),e.customization&&(0,s.jsxs)("div",{className:"text-gray-500 mt-1",children:[(0,s.jsx)("strong",{children:"Customization:"})," ",e.customization]}),e.quantity&&(0,s.jsxs)("div",{className:"text-gray-500 mt-1",children:[(0,s.jsx)("strong",{children:"Quantity:"})," ",e.quantity]})]},t)),(!e.items||0===e.items.length)&&(0,s.jsx)("p",{className:"text-gray-500",children:"No items available for this order."})]})]},e.id)})]}):null}},3708:(e,t,r)=>{Promise.resolve().then(r.bind(r,833))},5695:(e,t,r)=>{"use strict";var s=r(8999);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})}},e=>{var t=t=>e(e.s=t);e.O(0,[464,441,684,358],()=>t(3708)),_N_E=e.O()}]);