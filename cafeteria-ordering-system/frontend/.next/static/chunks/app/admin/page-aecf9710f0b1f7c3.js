(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{747:(e,t,a)=>{Promise.resolve().then(a.bind(a,7220))},5695:(e,t,a)=>{"use strict";var s=a(8999);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},7220:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var s=a(5155),n=a(2115),l=a(5695),r=a(3464);function i(){let[e,t]=(0,n.useState)("user"),[a,i]=(0,n.useState)(!1),[o,u]=(0,n.useState)(!0),c=(0,l.useRouter)(),[d,h]=(0,n.useState)(""),[p,m]=(0,n.useState)(""),[x,g]=(0,n.useState)(""),[j,v]=(0,n.useState)(""),[y,N]=(0,n.useState)("customer"),[b,f]=(0,n.useState)(""),[w,C]=(0,n.useState)(""),[S,k]=(0,n.useState)(""),[U,A]=(0,n.useState)(0),[D,E]=(0,n.useState)(""),[I,M]=(0,n.useState)(null),[R,P]=(0,n.useState)(""),[q,T]=(0,n.useState)(""),[_,L]=(0,n.useState)(0),[Q,B]=(0,n.useState)(""),[F,O]=(0,n.useState)(null),[$,z]=(0,n.useState)(""),[G,H]=(0,n.useState)(""),[J,K]=(0,n.useState)([]),[V,W]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{try{let e=await r.A.get("http://localhost:8080/currentuserread",{withCredentials:!0});e.data&&"admin"===e.data.role?i(!0):c.replace("/")}catch(e){console.error("Error checking admin:",e),c.replace("/")}finally{u(!1)}})()},[c]),(0,n.useEffect)(()=>{V&&(P(V.name),T(V.price.toString()),L(V.quantity),B(V.category||""),O(null),z(V.name))},[V]),(0,n.useEffect)(()=>{if(0===G.length)return void K([]);let e=setTimeout(async()=>{try{let e=await r.A.post("http://localhost:8080/cafmenusearch",{name:G},{withCredentials:!0});K(e.data)}catch(e){console.error("Search failed",e)}},300);return()=>clearTimeout(e)},[G]);let X=async()=>{try{await r.A.post("http://localhost:8080/updateUser",{username:d,name:p,password:x},{withCredentials:!0}),alert("User info updated."),es()}catch(e){console.error("Error updating user info:",e)}},Y=async()=>{try{await r.A.post("http://localhost:8080/updateRole",{username:j,role:y},{withCredentials:!0}),alert("User role updated."),es()}catch(e){console.error("Error updating role:",e)}},Z=async()=>{try{await r.A.post("http://localhost:8080/deleteUser",{username:b},{withCredentials:!0}),alert("User deleted."),es()}catch(e){console.error("Error deleting user:",e)}},ee=async()=>{let e=null;if(I){let t=new FileReader;t.onloadend=async()=>{e=t.result;try{await r.A.post("http://localhost:8080/cafmenuadd",{name:w,price:S,quantity:U,category:D,image:e},{withCredentials:!0,headers:{"Content-Type":"application/json"}}),alert("Menu item added."),es()}catch(e){console.error("Error adding item:",e)}},t.readAsDataURL(I)}else await r.A.post("http://localhost:8080/cafmenuadd",{name:w,price:S,quantity:U,category:D,image:null},{withCredentials:!0,headers:{"Content-Type":"application/json"}}),alert("Menu item added."),es()},et=async()=>{let e=null;if(F){let t=new FileReader;t.onloadend=async()=>{e=t.result;try{await r.A.post("http://localhost:8080/cafmenuupdate",{name:R,price:q,quantity:_,category:Q,image:e},{withCredentials:!0,headers:{"Content-Type":"application/json"}}),alert("Menu item updated."),es()}catch(e){console.error("Error updating item:",e)}},t.readAsDataURL(F)}else await r.A.post("http://localhost:8080/cafmenuupdate",{name:R,price:q,quantity:_,category:Q,image:null},{withCredentials:!0,headers:{"Content-Type":"application/json"}}),alert("Menu item updated."),es()},ea=async()=>{try{await r.A.post("http://localhost:8080/cafmenudelete",{name:$},{withCredentials:!0}),alert("Menu item deleted."),es()}catch(e){console.error("Error deleting item:",e)}},es=()=>{h(""),m(""),g(""),v(""),N("customer"),f(""),C(""),k(""),A(0),E(""),M(null),P(""),T(""),L(0),B(""),O(null),z(""),H(""),K([]),W(null)};return o?(0,s.jsx)("p",{children:"Loading..."}):a?(0,s.jsxs)("div",{className:"min-h-screen p-8 bg-gray-100",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-center mb-6",children:'"Admin Menu"'}),(0,s.jsxs)("div",{className:"flex justify-center space-x-4 mb-6",children:[(0,s.jsx)("button",{onClick:()=>t("user"),className:"bg-blue-500 text-white px-4 py-2 rounded",children:"Manage Users"}),(0,s.jsx)("button",{onClick:()=>t("menu"),className:"bg-green-500 text-white px-4 py-2 rounded",children:"Edit Cafeteria Menu"})]}),"user"===e&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Update User Info"}),(0,s.jsx)("input",{type:"text",placeholder:"Username/Email",value:d,onChange:e=>h(e.target.value),className:"input"}),(0,s.jsx)("input",{type:"text",placeholder:"New Name",value:p,onChange:e=>m(e.target.value),className:"input"}),(0,s.jsx)("input",{type:"text",placeholder:"New Password",value:x,onChange:e=>g(e.target.value),className:"input"}),(0,s.jsx)("button",{onClick:X,className:"button-blue",children:"Update Info"})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Promote/Demote User"}),(0,s.jsx)("input",{type:"text",placeholder:"Username",value:j,onChange:e=>v(e.target.value),className:"input"}),(0,s.jsxs)("select",{className:"input",value:y,onChange:e=>N(e.target.value),children:[(0,s.jsx)("option",{value:"admin",children:"Admin"}),(0,s.jsx)("option",{value:"cafeteria",children:"Cafeteria Staff"}),(0,s.jsx)("option",{value:"delivery",children:"Delivery Driver"}),(0,s.jsx)("option",{value:"customer",children:"Customer"})]}),(0,s.jsx)("button",{onClick:Y,className:"button-blue",children:"Update Role"})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Delete User"}),(0,s.jsx)("input",{type:"text",placeholder:"Username",value:b,onChange:e=>f(e.target.value),className:"input"}),(0,s.jsx)("button",{onClick:Z,className:"button-red",children:"Delete User"})]})]}),"menu"===e&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Search Menu Item"}),(0,s.jsx)("input",{type:"text",placeholder:"Search by name...",value:G,onChange:e=>H(e.target.value),className:"input"}),J.length>0&&(0,s.jsx)("ul",{className:"border rounded mt-2 max-h-40 overflow-y-auto",children:J.map(e=>(0,s.jsxs)("li",{className:"p-2 cursor-pointer hover:bg-gray-100",onClick:()=>{W(e),H(e.name),K([])},children:[e.name," - $",e.price," (Qty: ",e.quantity,")"]},e.id))})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Add Menu Item"}),(0,s.jsx)("input",{type:"text",placeholder:"New Item Name",value:w,onChange:e=>C(e.target.value),className:"input"}),(0,s.jsx)("input",{type:"text",placeholder:"Price",value:S,onChange:e=>k(e.target.value),className:"input"}),(0,s.jsx)("input",{type:"number",placeholder:"Quantity",value:U,onChange:e=>A(Number(e.target.value)),className:"input"}),(0,s.jsxs)("select",{value:D,onChange:e=>E(e.target.value),className:"input",children:[(0,s.jsx)("option",{value:"",children:"Select Category"}),(0,s.jsx)("option",{value:"breakfast",children:"Breakfast"}),(0,s.jsx)("option",{value:"lunch",children:"Lunch"}),(0,s.jsx)("option",{value:"dinner",children:"Dinner"}),(0,s.jsx)("option",{value:"dessert",children:"Dessert"}),(0,s.jsx)("option",{value:"drink",children:"Drink"})]}),(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{e.target.files&&M(e.target.files[0])},className:"input"}),(0,s.jsx)("button",{onClick:ee,className:"button-blue",children:"Add Item"})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Update Menu Item"}),(0,s.jsx)("input",{type:"text",placeholder:"Item Name",value:R,onChange:e=>P(e.target.value),className:"input"}),(0,s.jsx)("input",{type:"text",placeholder:"New Price",value:q,onChange:e=>T(e.target.value),className:"input"}),(0,s.jsx)("input",{type:"number",placeholder:"New Quantity",value:_,onChange:e=>L(Number(e.target.value)),className:"input"}),(0,s.jsxs)("select",{value:D,onChange:e=>E(e.target.value),className:"input",children:[(0,s.jsx)("option",{value:"",children:"Select Category"}),(0,s.jsx)("option",{value:"breakfast",children:"Breakfast"}),(0,s.jsx)("option",{value:"lunch",children:"Lunch"}),(0,s.jsx)("option",{value:"dinner",children:"Dinner"}),(0,s.jsx)("option",{value:"dessert",children:"Dessert"}),(0,s.jsx)("option",{value:"drink",children:"Drink"})]}),(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{e.target.files&&O(e.target.files[0])},className:"input"}),(0,s.jsx)("button",{onClick:et,className:"button-blue",children:"Update Item"})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Delete Menu Item"}),(0,s.jsx)("input",{type:"text",placeholder:"Item Name",value:$,onChange:e=>z(e.target.value),className:"input"}),(0,s.jsx)("button",{onClick:ea,className:"button-red",children:"Delete Item"})]})]})]}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[464,441,684,358],()=>t(747)),_N_E=e.O()}]);