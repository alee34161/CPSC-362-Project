(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{747:(e,t,a)=>{Promise.resolve().then(a.bind(a,7220))},5695:(e,t,a)=>{"use strict";var s=a(8999);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},7220:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var s=a(5155),l=a(2115),n=a(5695),r=a(3464);function u(){let[e,t]=(0,l.useState)("user"),[a,u]=(0,l.useState)(!1),[o,i]=(0,l.useState)(!0),c=(0,n.useRouter)(),[d,h]=(0,l.useState)(""),[m,p]=(0,l.useState)(""),[x,b]=(0,l.useState)(""),[N,g]=(0,l.useState)(""),[v,j]=(0,l.useState)("customer"),[y,w]=(0,l.useState)(""),[f,C]=(0,l.useState)(""),[S,U]=(0,l.useState)(""),[E,k]=(0,l.useState)(0),[A,I]=(0,l.useState)(""),[M,P]=(0,l.useState)(""),[D,R]=(0,l.useState)(0),[_,q]=(0,l.useState)(""),[Q,O]=(0,l.useState)(""),[T,L]=(0,l.useState)([]),[$,z]=(0,l.useState)(null);(0,l.useEffect)(()=>{(async()=>{try{let e=await r.A.get("http://localhost:8080/currentuserread",{withCredentials:!0});e.data&&"admin"===e.data.role?u(!0):c.replace("/")}catch(e){console.error("Error checking admin:",e),c.replace("/")}finally{i(!1)}})()},[c]),(0,l.useEffect)(()=>{$&&(I($.name),P($.price.toString()),R($.quantity),q($.name))},[$]),(0,l.useEffect)(()=>{if(0===Q.length){L([]);return}let e=setTimeout(async()=>{try{let e=await r.A.post("http://localhost:8080/cafmenusearch",{name:Q},{withCredentials:!0});L(e.data)}catch(e){console.error("Search failed",e)}},300);return()=>clearTimeout(e)},[Q]);let B=async()=>{try{await r.A.post("http://localhost:8080/updateUser",{username:d,name:m,password:x},{withCredentials:!0}),alert("User info updated."),V()}catch(e){console.error("Error updating user info:",e)}},F=async()=>{try{await r.A.post("http://localhost:8080/updateRole",{username:N,role:v},{withCredentials:!0}),alert("User role updated."),V()}catch(e){console.error("Error updating role:",e)}},G=async()=>{try{await r.A.post("http://localhost:8080/deleteUser",{username:y},{withCredentials:!0}),alert("User deleted."),V()}catch(e){console.error("Error deleting user:",e)}},H=async()=>{try{await r.A.post("http://localhost:8080/cafmenuadd",{name:f,price:S,quantity:E},{withCredentials:!0}),alert("Menu item added."),V()}catch(e){console.error("Error adding item:",e)}},J=async()=>{try{await r.A.post("http://localhost:8080/cafmenuupdate",{name:A,price:M,quantity:D},{withCredentials:!0}),alert("Menu item updated."),V()}catch(e){console.error("Error updating item:",e)}},K=async()=>{try{await r.A.post("http://localhost:8080/cafmenudelete",{name:_},{withCredentials:!0}),alert("Menu item deleted."),V()}catch(e){console.error("Error deleting item:",e)}},V=()=>{h(""),p(""),b(""),g(""),j("customer"),w(""),C(""),U(""),k(0),I(""),P(""),R(0),q(""),O(""),L([]),z(null)};return o?(0,s.jsx)("p",{children:"Loading..."}):a?(0,s.jsxs)("div",{className:"min-h-screen p-8 bg-gray-100",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-center mb-6",children:"Admin Menu"}),(0,s.jsxs)("div",{className:"flex justify-center space-x-4 mb-6",children:[(0,s.jsx)("button",{onClick:()=>t("user"),className:"bg-blue-500 text-white px-4 py-2 rounded",children:"Manage Users"}),(0,s.jsx)("button",{onClick:()=>t("menu"),className:"bg-green-500 text-white px-4 py-2 rounded",children:"Edit Cafeteria Menu"})]}),"user"===e&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Update User Info"}),(0,s.jsx)("input",{type:"text",placeholder:"Username/Email",value:d,onChange:e=>h(e.target.value),className:"input"}),(0,s.jsx)("input",{type:"text",placeholder:"New Name",value:m,onChange:e=>p(e.target.value),className:"input"}),(0,s.jsx)("input",{type:"text",placeholder:"New Password",value:x,onChange:e=>b(e.target.value),className:"input"}),(0,s.jsx)("button",{onClick:B,className:"button-blue",children:"Update Info"})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Promote/Demote User"}),(0,s.jsx)("input",{type:"text",placeholder:"Username",value:N,onChange:e=>g(e.target.value),className:"input"}),(0,s.jsxs)("select",{className:"input",value:v,onChange:e=>j(e.target.value),children:[(0,s.jsx)("option",{value:"admin",children:"Admin"}),(0,s.jsx)("option",{value:"cafeteria",children:"Cafeteria Staff"}),(0,s.jsx)("option",{value:"delivery",children:"Delivery Driver"}),(0,s.jsx)("option",{value:"customer",children:"Customer"})]}),(0,s.jsx)("button",{onClick:F,className:"button-blue",children:"Update Role"})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Delete User"}),(0,s.jsx)("input",{type:"text",placeholder:"Username",value:y,onChange:e=>w(e.target.value),className:"input"}),(0,s.jsx)("button",{onClick:G,className:"button-red",children:"Delete User"})]})]}),"menu"===e&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Search Menu Item"}),(0,s.jsx)("input",{type:"text",placeholder:"Search by name...",value:Q,onChange:e=>O(e.target.value),className:"input"}),T.length>0&&(0,s.jsx)("ul",{className:"border rounded mt-2 max-h-40 overflow-y-auto",children:T.map(e=>(0,s.jsxs)("li",{className:"p-2 cursor-pointer hover:bg-gray-100",onClick:()=>{z(e),O(e.name),L([])},children:[e.name," - $",e.price," (Qty: ",e.quantity,")"]},e.id))})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Add Menu Item"}),(0,s.jsx)("input",{type:"text",placeholder:"Item Name",value:f,onChange:e=>C(e.target.value),className:"input"}),(0,s.jsx)("input",{type:"text",placeholder:"Price",value:S,onChange:e=>U(e.target.value),className:"input"}),(0,s.jsx)("input",{type:"number",placeholder:"Quantity",value:E,onChange:e=>k(Number(e.target.value)),className:"input"}),(0,s.jsx)("button",{onClick:H,className:"button-blue",children:"Add Item"})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Update Menu Item"}),(0,s.jsx)("input",{type:"text",placeholder:"Item Name",value:A,onChange:e=>I(e.target.value),className:"input"}),(0,s.jsx)("input",{type:"text",placeholder:"New Price",value:M,onChange:e=>P(e.target.value),className:"input"}),(0,s.jsx)("input",{type:"number",placeholder:"New Quantity",value:D,onChange:e=>R(Number(e.target.value)),className:"input"}),(0,s.jsx)("button",{onClick:J,className:"button-blue",children:"Update Item"})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Delete Menu Item"}),(0,s.jsx)("input",{type:"text",placeholder:"Item Name",value:_,onChange:e=>q(e.target.value),className:"input"}),(0,s.jsx)("button",{onClick:K,className:"button-red",children:"Delete Item"})]})]})]}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[464,441,684,358],()=>t(747)),_N_E=e.O()}]);